<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <title>4.3 Messages 1.0.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <ul>
        <li>
            <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                <a href="../../guide/index.html" class="button">Table of contents</a>

                <div id="nav-summary-childs" style="display:none;">
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/introduction.html"><strong>1</strong><span>Introduction To The RabbitMQ Plugin</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/configuration.html"><strong>2</strong><span>Configuration</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/sendingMessages.html"><strong>3</strong><span>Sending Messages</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/consumingMessages.html"><strong>4</strong><span>Consuming Messages</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0"><a href="../../guide/rabbitTemplate.html"><strong>5</strong><span>Using The RabbitTemplate Directly</span></a>
                    </div>
                    
                </div>
            </div>
        </li>
        <li class="separator selected">
            <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
        </li>
    </ul>
</div>
<div id="header">
    <div class="images clearfix">
        
        
    </div>
    <p>The RabbitMQ plugin provides integration with the RabbitMQ Messaging System.</p>
</div>


<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../../guide/sendingMessages.html">&lt;&lt; <strong>3</strong><span>Sending Messages</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../../guide/rabbitTemplate.html"><strong>5</strong><span>Using The RabbitTemplate Directly</span> >></a></div>
                


                <div class="project">
                    <h1>4.3 Messages - Reference Documentation</h1>

                    <p><strong>Authors:</strong> Jeff Brown, Peter Ledbrook</p>

                    <p><strong>Version:</strong> 1.0.0</p>

                    
                </div>

                

                
<a name="4.3 Messages"><!-- Legacy link --></a>
<h2 id="messages">4.3 Messages</h2>
What is a message? In the examples you've seen in this section, the message has been some arbitrary object but we haven't discussed what the type of that object might be. That's because, it can be pretty much anything! Within the messaging system, the content of a message is simply a byte array - it's up to the producer can consumer to interpret/convert that raw data.<p class="paragraph"/>Fortunately the plugin (via <a href="http://static.springsource.org/spring-amqp/docs/1.0.x/reference/html/#d0e335" target="blank">Spring AMQP</a>) automatically handles messages whose content is in familiar forms, including:
<ul class="star">
<li>strings</li>
<li>byte arrays</li>
<li>maps</li>
<li>other serializable types</li>
</ul><p class="paragraph"/>One manifestation of this support is that different message types may be handled with overloaded versions of <code>handleMessage()</code>:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> org.grails.rabbitmq.test<p class="paragraph"/>class DemoService &#123;
    <span class="java&#45;keyword">static</span> rabbitQueue = 'someQueueName'<p class="paragraph"/>    void handleMessage(<span class="java&#45;object">String</span> textMessage) &#123;
        // handle <span class="java&#45;object">String</span> message&#8230;
    &#125;<p class="paragraph"/>    void handleMessage(Map mapMessage) &#123;
        // handle Map message&#8230;
    &#125;<p class="paragraph"/>    void handleMessage(<span class="java&#45;object">byte</span>&#91;&#93; byteMessage) &#123;
        // handle <span class="java&#45;object">byte</span> array message&#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/>This is a great convenience, but be aware that using serializable Java objects limits the types of client you can interact with. If all the clients you're interested in are using Spring AMQP, then you should be fine, but don't expect Ruby or Python clients to handle <code>Map</code> messages! For production systems, we recommend you use strings and byte arrays.<p class="paragraph"/>Sometimes you want access to the raw message, particularly if you want to look at the message headers. If so, just change the signature of the <code>handleMessage()</code> method and add an extra option to your <code>rabbitQueue</code> or <code>rabbitSubscribe</code> property:<p class="paragraph"/><div class="code"><pre><span class="java&#45;keyword">package</span> org.grails.rabbitmq.test<p class="paragraph"/><span class="java&#45;keyword">import</span> org.springframework.amqp.core.Message<p class="paragraph"/>class DemoService &#123;
    <span class="java&#45;keyword">static</span> rabbitQueue = &#91;queues: 'someQueueName', messageConverterBean: ''&#93;<p class="paragraph"/>    void handleMessage(Message msg) &#123;
        // Do something with the message headers
        println <span class="java&#45;quote">"Received message with content type $&#123;msg.contentType&#125;;$&#123;msg.encoding&#125;"</span>
        &#8230;
    &#125;
&#125;</pre></div><p class="paragraph"/>As you can see, all you have to do is accept an argument of type <code>Message</code> and add the <code>messageConverterBean</code> option with an empty string as its value. This disables the automatic message conversion, allowing you to interrogate the raw message as required.



                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../../guide/sendingMessages.html">&lt;&lt; <strong>3</strong><span>Sending Messages</span></a></div>
                
                    <div class="toc-item next-right"><a href="../../guide/rabbitTemplate.html"><strong>5</strong><span>Using The RabbitTemplate Directly</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">All Classes</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../../ref/All%20Classes/rabbitSend.html">rabbitSend</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
